#!/bin/sh

# -e: exit on error
# -u: exit on unset variables
set -eu

# This script installs Visual Studio Code on macOS and the Pylance extension

# Check if VS Code is already installed
if [ -d "/Applications/Visual Studio Code.app" ] || [ -d "${HOME}/Applications/Visual Studio Code.app" ]; then
  echo "Visual Studio Code is already installed."
else
  echo "Installing Visual Studio Code..."
  # Install VS Code on macOS using Homebrew
  if command -v brew >/dev/null 2>&1; then
    brew install --cask visual-studio-code
  else
    echo "Homebrew not found. Please install Homebrew first: https://brew.sh/"
    exit 1
  fi
  echo "Visual Studio Code has been installed successfully."
fi

# Install Pylance extension
if command -v code >/dev/null 2>&1; then
  echo "Installing Pylance extension for VS Code..."
  code --install-extension ms-python.vscode-pylance
  echo "Pylance extension has been installed successfully."
else
  echo "WARNING: 'code' command not found. Make sure VS Code was installed correctly."
  echo "You may need to manually install the Pylance extension from the VS Code marketplace."
  exit 1
fi
