#!/bin/sh
# chezmoi:template:left-delimiter="# [[" right-delimiter="]] #"
# Simple test for chezmoi variables and GitHub CLI authentication

set -eu

# Ensure GitHub CLI is authenticated before proceeding
if ! gh auth status >/dev/null 2>&1; then
  echo "ERROR: GitHub CLI authentication required."
  echo "Please authenticate using one of these methods:"
  echo "1. Run 'gh auth login' in an interactive terminal"
  echo "2. Set the GH_TOKEN or GITHUB_TOKEN environment variable"
  exit 1
fi

# Create a test file to verify these variables
TEST_FILE="${HOME}/.local/share/chezmoi-test-variables.txt"
mkdir -p "$(dirname "$TEST_FILE")"

cat > "$TEST_FILE" << EOF
Name: # [[ .name ]] #
Email: # [[ .email ]] #
EOF
